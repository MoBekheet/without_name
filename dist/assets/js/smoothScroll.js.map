{"version":3,"sources":["../../../src/assets/js/smoothScroll.js"],"names":["MathUtils","map","x","a","b","c","d","lerp","n","body","document","winsize","calcWinsize","width","window","innerWidth","height","innerHeight","addEventListener","docScroll","getPageYScroll","pageYOffset","documentElement","scrollTop","Item","el","DOM","image","querySelector","renderedStyles","innerTranslationY","previous","current","ease","maxValue","parseInt","setValue","minValue","Math","max","min","props","top","update","observer","IntersectionObserver","entries","forEach","entry","isVisible","intersectionRatio","observe","initEvents","getSize","key","layout","rect","getBoundingClientRect","resize","render","style","transform","SmoothScroll","main","scrollable","items","querySelectorAll","item","push","translationY","setSize","requestAnimationFrame","scrollHeight","position","left","overflow","preloadImages","Promise","resolve","reject","imagesLoaded","background","then","classList","remove"],"mappings":"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","sourcesContent":["{\n  const MathUtils = {\n    map: (x, a, b, c, d) => (x - a) * (d - c) / (b - a) + c,\n    lerp: (a, b, n) => (1 - n) * a + n * b\n  };\n\n  const body = document.body;\n\n  let winsize;\n  const calcWinsize = () => winsize = { width: window.innerWidth, height: window.innerHeight };\n  calcWinsize();\n  window.addEventListener('resize', calcWinsize);\n\n  let docScroll;\n  const getPageYScroll = () => docScroll = window.pageYOffset || document.documentElement.scrollTop;\n  window.addEventListener('scroll', getPageYScroll);\n\n  class Item {\n    constructor(el) {\n      this.DOM = { el: el };\n      this.DOM.image = this.DOM.el.querySelector('.item__img');\n      \n      this.renderedStyles = {\n        innerTranslationY: {\n          previous: 0,\n          current: 0,\n          ease: 0.1,\n          // maxValue: parseInt(getComputedStyle(this.DOM.image).getPropertyValue('--overflow'), 10),\n          maxValue: parseInt(40, 10),\n          setValue: () => {\n            const maxValue = this.renderedStyles.innerTranslationY.maxValue;\n            const minValue = -1 * maxValue;\n            return Math.max(Math.min(MathUtils.map(this.props.top - docScroll, winsize.height, -1 * this.props.height, minValue, maxValue), maxValue), minValue)\n          }\n        }\n      };\n      this.update();\n      this.observer = new IntersectionObserver((entries) => {\n        entries.forEach(entry => this.isVisible = entry.intersectionRatio > 0);\n      });\n      this.observer.observe(this.DOM.el);\n      this.initEvents();\n    }\n    update() {\n      this.getSize();\n      for (const key in this.renderedStyles) {\n        this.renderedStyles[key].current = this.renderedStyles[key].previous = this.renderedStyles[key].setValue();\n      }\n      this.layout();\n    }\n    getSize() {\n      const rect = this.DOM.el.getBoundingClientRect();\n      this.props = {\n        height: rect.height,\n        top: docScroll + rect.top\n      }\n    }\n    initEvents() {\n      window.addEventListener('resize', () => this.resize());\n    }\n    resize() {\n      this.update();\n    }\n    render() {\n      for (const key in this.renderedStyles) {\n        this.renderedStyles[key].current = this.renderedStyles[key].setValue();\n        this.renderedStyles[key].previous = MathUtils.lerp(this.renderedStyles[key].previous, this.renderedStyles[key].current, this.renderedStyles[key].ease);\n      }\n      this.layout();\n    }\n    layout() {\n      this.DOM.image.style.transform = `translate3d(0,${this.renderedStyles.innerTranslationY.previous}px,0)`;\n    }\n  }\n\n  class SmoothScroll {\n    constructor() {\n      this.DOM = { main: document.querySelector('main') };\n      this.DOM.scrollable = this.DOM.main.querySelector('div[data-scroll]');\n      this.items = [];\n      [...this.DOM.main.querySelectorAll('.item_scroll')].forEach(item => this.items.push(new Item(item)));\n      this.renderedStyles = {\n        translationY: {\n          previous: 0,\n          current: 0,\n          ease: 0.1,\n          setValue: () => docScroll\n        }\n      };\n      this.setSize();\n      this.update();\n      // this.style();\n      this.initEvents();\n      requestAnimationFrame(() => this.render());\n    }\n    update() {\n      for (const key in this.renderedStyles) {\n        this.renderedStyles[key].current = this.renderedStyles[key].previous = this.renderedStyles[key].setValue();\n      }\n      this.layout();\n    }\n    layout() {\n      this.DOM.scrollable.style.transform = `translate3d(0,${-1 * this.renderedStyles.translationY.previous}px,0)`;\n    }\n    setSize() {\n      body.style.height = `${this.DOM.scrollable.scrollHeight}px`;\n    }\n    style() {\n      this.DOM.main.style.position = 'fixed';\n      this.DOM.main.style.width = this.DOM.main.style.height = '100%';\n      this.DOM.main.style.top = this.DOM.main.style.left = 0;\n      this.DOM.main.style.overflow = 'hidden';\n    }\n    initEvents() {\n      window.addEventListener('resize', () => this.setSize());\n    }\n    render() {\n      for (const key in this.renderedStyles) {\n        this.renderedStyles[key].current = this.renderedStyles[key].setValue();\n        this.renderedStyles[key].previous = MathUtils.lerp(this.renderedStyles[key].previous, this.renderedStyles[key].current, this.renderedStyles[key].ease);\n      }\n      this.layout();\n      for (const item of this.items) {\n        if (item.isVisible) {\n          item.render();\n        }\n      }\n      requestAnimationFrame(() => this.render());\n    }\n  }\n  const preloadImages = () => {\n    return new Promise((resolve, reject) => {\n      imagesLoaded(document.querySelectorAll('.item__img'), { background: true }, resolve);\n    });\n  };\n  preloadImages().then(() => {\n    document.body.classList.remove('loading');\n    getPageYScroll();\n    new SmoothScroll();\n  });\n}"],"file":"smoothScroll.js"}